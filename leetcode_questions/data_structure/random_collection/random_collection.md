# 带重复元素的插入删除随机访问数据结构

## 题目描述
设计一个支持以下操作的数据结构：
- insert(val)：插入一个元素，如果元素不存在返回true，否则返回false
- remove(val)：删除一个元素，如果元素存在返回true，否则返回false
- getRandom()：随机返回一个元素

要求：所有操作的期望时间复杂度为 O(1)，允许元素重复。

## 示例
```python
collection = RandomizedCollection()
collection.insert(1)   # 返回 true
collection.insert(1)   # 返回 false（已存在）
collection.insert(2)   # 返回 true
collection.getRandom() # 随机返回 1 或 2
collection.remove(1)   # 返回 true
collection.getRandom() # 随机返回 1 或 2
```

## 解题思路

### 数据结构设计
使用两个主要的数据结构：
1. **动态数组**：存储所有元素，支持O(1)的随机访问
2. **哈希表**：存储值到索引集合的映射，处理重复元素

### 关键实现点

1. **插入操作 O(1)**
   - 将元素添加到数组末尾
   - 在哈希表中记录索引
   - 处理重复元素的情况

2. **删除操作 O(1)**
   - 找到要删除元素的一个索引
   - 将最后一个元素移到该位置
   - 更新哈希表中的索引信息
   - 删除数组最后一个元素

3. **随机访问 O(1)**
   - 直接使用数组的随机访问能力
   - Python的random.choice实现了这一功能

### 难点解析
1. **处理重复元素**
   - 使用集合存储同一个值的所有索引
   - 删除时需要维护索引集合

2. **删除操作的复杂性**
   - 需要保持数组连续
   - 需要正确更新被移动元素的索引
   - 需要处理边界情况

### 复杂度分析
- 时间复杂度：O(1) 期望
  - insert：O(1)
  - remove：O(1)
  - getRandom：O(1)
- 空间复杂度：O(n)
  - n是元素总数（包括重复元素）

## 实现注意事项
1. 正确处理重复元素
2. 删除操作时注意更新索引
3. 处理边界情况（空集合、单个元素等）
4. 维护数据结构的一致性

## 面试建议
- 理解基本思路比完整实现更重要
- 重点说明如何处理重复元素
- 解释为什么操作是O(1)的
- 讨论可能的优化方向 